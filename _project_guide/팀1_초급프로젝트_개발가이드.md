# 팀1 초급프로젝트 개발가이드

## 🎯 준비 수준

프로젝트 초기 설정이 완료되었으며,
아래 안내대로 적용하면 바로 개발작업을 시작할 수 있습니다.

## ✅ 완료된 작업

### 1. 프로젝트 구조

- Express.js 기본 설정 완료
- Prisma 스키마 정의 완료
- 디렉토리 구조 설정 완료
  - 이미지 폴더는 빈 폴더이므로 .gitkeep 추가됨

### 2. 기본 기능 구현

- ✅ 서버 상태 체크 API (`/health`, `/health/db`)
- ✅ Global Error Handler
- ✅ 디버그 유틸리티

### 3. 개발 환경 설정

- `.env` 파일 설정
- `.gitignore` 설정
- Prisma 클라이언트 설정

## 📋 Git에 반영할 파일

### ✅ 포함하되 변경점이 있는 파일만 반영

```bash
# 소스 코드 (작업 내용과 관련있는 파일)
src/

# Prisma 스키마 (변경이 있는 경우)
prisma/schema.prisma

# 설정 파일 (변경이 있는 경우)
package.json
.gitignore
.env.sample  # 주의: .env.sample만 포함해주세요

# 디렉토리 보존
public/uploads/.gitkeep
```

### ❌ 절대 포함 금지

```bash
# 패키지
node_modules/

# 환경 변수 (민감 정보)
.env

# 업로드된 파일
public/uploads/*  # (.gitkeep 제외)

# 개인 파일 (테스트, 임시 작업)
temp/  # 개인 파일 보관용 폴더

# 로그
*.log
logs/

# IDE 설정
.vscode/
.idea/
```

> ⚠️ **개인 파일 보관**: `temp/` 폴더는 `.gitignore`에 포함되어 있습니다.  
> 테스트 코드, 임시 작업 파일 등 개인적으로 필요한 파일은 이 폴더에 보관하세요.

## 🚀 환경 셋팅 방법

### 1단계: 저장소 포크 및 클론

```bash
# 1. GitHub에서 저장소 포크
# https://github.com/shpocher/nb6-seven-team1 페이지로 이동
# 우측 상단 "Fork" 버튼 클릭
# 자신의 계정으로 포크

# 2. 포크한 저장소 클론
git clone https://github.com/your-username/nb6-seven-team1.git
cd nb6-seven-team1

# 2. 패키지 설치
npm install

# 3. 환경 변수 설정
cp .env.sample .env
# .env 파일을 열어서 DATABASE_URL 정보 수정 (유저명, 암호, 포트 등 확인)

# 4. 데이터베이스 설정
# PostgreSQL에 nb6_seven_db 데이터베이스 생성 (.env.sample 참고)
# 윈도우 사용자는 PostgreSQL에 설치된 SQL Shell (psql) 이용하여 입력
createdb nb6_seven_db

# 5. Prisma 마이그레이션 (현재 git에 migrations 포함됨)
npx prisma migrate deploy
npx prisma generate

# 나중에 마이그레이션 없이 초기 셋팅 시 아래 명령어 (prisma 초기화)
# npx prisma migrate dev --name init
# npx prisma generate

# 6. 개인 작업 폴더 생성 (.gitignore에 추가됨)
mkdir temp  # 개인 테스트 파일, 임시 작업용

# 7. 서버 실행 테스트
npm run dev

# 8. API 테스트
# 브라우저에서 URL 접속하셔도 확인 가능
curl http://localhost:3000/health
curl http://localhost:3000/health/db


# 9. 이미지 파일 테스트
# 브라우저에서 URL 접속 확인 가능
http://localhost:3000/uploads/test_image.jpg

```

### 2단계: 작업 브랜치 생성

```bash
# feature 브랜치로 전환 (모든 작업은 feature 브랜치에서 시작)
git checkout feature

# 최신 코드 받기
git pull origin feature

# 자신의 작업 브랜치 생성 (feature 브랜치에서 분기)
git checkout -b feature/your-feature-name

# 예시:
# git checkout -b feature/{기능이름}
# git checkout -b feature/record-list-api
```

### 3단계: 작업 시작

각자 맡은 API를 구현합니다.

**필요한 파일:**

1. Controller: `src/controllers/[기능]-controller.js`
2. Router: `src/routes/[기능]-routes.js`
3. Validator (필요에 따라): `src/validators/[기능]-validator.js`

**app.js 수정:**

```javascript
// src/app.js에 라우터 등록
import yourRoutes from "./routes/your-routes.js";
app.use("/your-path", yourRoutes);
```

## 📝 작업 예시: 그룹 생성 API

### 1. Controller 생성

```javascript
// src/controllers/group-controller.js
import prisma from "../utils/prisma.js";
import {
  NotFoundError,
  ValidationError,
} from "../middlewares/error-handler.js";

class GroupController {
  async createGroup(req, res) {
    // 구현...
  }

  async getGroups(req, res) {
    // 구현...
  }

  // 다른 메서드들...
}

export default new GroupController();
```

### 2. Router 생성

```javascript
// src/routes/group-routes.js
import express from "express";
import groupController from "../controllers/group-controller.js";

const router = express.Router();

router.post("/", groupController.createGroup);
router.get("/", groupController.getGroups);
// 다른 라우트들...

export default router;
```

### 3. app.js에 등록

```javascript
// src/app.js
import groupRoutes from "./routes/group-routes.js";

// 라우터 등록
app.use("/groups", groupRoutes);
```

### 4. 테스트

```bash
# 서버 재시작 (nodemon이 자동으로 재시작)
# 또는 수동으로:
npm run dev

# API 테스트
curl -X POST http://localhost:3000/groups \
  -H "Content-Type: application/json" \
  -d '{"name":"테스트 그룹",...}'
```

### 5. 커밋 및 푸시

```bash
git add .
git commit -m "feat: 그룹 생성 API 구현"
git push origin feature/group-create-api

# GitHub에서 Pull Request 생성
```

## 🔧 개발 시 유의사항

### 1. 코드 컨벤션 준수

- 파일명: `kebab-case`
- 변수/함수명: `camelCase`
- 클래스명: `PascalCase`
- 들여쓰기: 2칸
- 세미콜론 사용

자세한 내용은 `guide-code-convention.md` 참고

### 2. 에러 처리

- 간략하게 만들었으니, 개별 작업 시 필요한 경우 추가하셔도 됩니다!
- 미들웨어>error-handler.js에 동작 및 방식 주석 자세하게 기재했으니 확인해주세요.

```javascript
// 커스텀 에러 사용
throw new NotFoundError("그룹을 찾을 수 없습니다");
throw new UnauthorizedError("비밀번호가 일치하지 않습니다");
throw new ValidationError("입력 데이터가 올바르지 않습니다");
throw new ConflictError("이미 존재하는 데이터입니다");
```

### 3. 디버그 로그 사용 예시

- 사용이 어려울 수 있으니, console.log대신 debugLog 사용한다 생각해주세요.
- 프로젝트 진행 중 console.log 사용해도 괜찮습니다.
- debugError는 Global Error handler와 역할이 다릅니다.

```javascript
import { debugLog, debugError } from "../utils/debug.js";

// 1. debugLog: 개발 흐름 추적 (언제든 안전)
debugLog("정상 처리:", data);

// 2. debugError: 주의가 필요한 상황 (선택사항이거나 부차적 기능) -> 경고만 기록
try {
  await optionalFeature();
} catch (error) {
  debugError("특정 상황 실패:", error); // 로깅만 함
}

// 3. throw: 진행할 수 없는 에러 (예상된 또는 심각한) -> 클라이언트 응답이 수반됨
if (!required) {
  throw new NotFoundError("필수 데이터 없음");
  // Global Error Handler로 처리 + 응답
}

// 4. debugError + throw: 예상치 못한 심각한 에러 -> debugError로 로깅도 하고, 핸들링도 같이
try {
  await criticalOperation();
} catch (error) {
  debugError("심각한 에러:", error); // 로깅 + throw
  throw error;
}
```

## 💡 자주 물으실 것 같은 질문 정리

### Q1: Prisma Client 에러가 발생해요

```bash
# Prisma Client 재생성
npx prisma generate
```

### Q2: 데이터베이스 스키마를 수정했어요

```bash
# 마이그레이션 생성 및 적용
npx prisma migrate dev --name 변경내용
```

### Q3: 다른 사람의 코드와 충돌이 발생했어요

```bash
# feature 브랜치의 최신 코드 가져오기
git fetch origin
git merge origin/feature

# 충돌 파일 수정 후
git add .
git commit -m "merge: feature 브랜치와 병합"
```

### Q4: console.log를 사용해도 되나요? (선택)

```javascript
// ❌ 직접 console.log 사용 지양
console.log("디버그 정보");

// ✅ debugLog 사용 권장
import { debugLog } from "../utils/debug.js";
debugLog("디버그 정보");
```

## 🚨 주의사항

1. **절대 .env 파일을 Git에 올리지 마세요!**

   - 민감 정보가 포함되어 있습니다
   - `.gitignore`에 포함되어 있으므로 자동으로 제외됩니다

2. **main 브랜치에 직접 푸시하지 마세요!**

   - 반드시 feature 브랜치에서 작업 브랜치를 만들어서 작업
   - Pull Request를 통해 feature에 병합

3. **node_modules를 Git에 올리지 마세요!**

   - `.gitignore`에 포함되어 있으므로 자동으로 제외됩니다
   - `package.json`으로 의존성 관리

4. **개인 파일은 temp/ 폴더를 활용하세요!**
   - 테스트 코드, 임시 작업 파일은 `temp/` 폴더에 보관
   - 이 폴더는 Git에 추적되지 않습니다

---

**작성일**: 2025.11.05
**팀**: NB6-1팀
**작성자**: 상휘
**버전**: 1.0

화이팅! 🚀
